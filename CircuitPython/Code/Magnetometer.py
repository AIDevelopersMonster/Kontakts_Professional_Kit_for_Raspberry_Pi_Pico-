# Video https://youtu.be/rOdW0SOZBA8
# Post http://kontakts.ru/showthread.php/40884?p=86209#post86209
# Telega https://t.me/MrMicroPython
# üìú –õ–∏—Ü–µ–Ω–∑–∏—è üîó Creative Commons Attribution-ShareAlike 4.0 (CC BY-SA)
# üìÇ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø–ª–∞—Ç—ã PicoMate https://wiki.deskpi.com/picomate/#pinout-diagram
import time 
import board 
import busio
from adafruit_mmc56x3 import MMC5603  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–æ–º MMC5603

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ I2C –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–æ–º
i2c1 = busio.I2C(scl = board.GP15, sda = board.GP14)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º I2C —Å –ø–∏–Ω–∞–º–∏ GP15 –¥–ª—è SCL –∏ GP14 –¥–ª—è SDA

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞ MMC5603, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∫ —à–∏–Ω–µ I2C
magnetometer = MMC5603(i2c1)

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞ –≤ 1000 –ì—Ü (–∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ—Ç 1 –¥–æ 1000 –ì—Ü)
magnetometer.data_rate = 1000   # –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –≥–µ—Ä—Ü–∞—Ö (–æ—Ç 1 –¥–æ 255 –∏–ª–∏ 1000)

# –í–∫–ª—é—á–∞–µ–º –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞, —á—Ç–æ–±—ã –æ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª –¥–∞–Ω–Ω—ã–µ
magnetometer.continuous_mode = True

# –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –º–∞–≥–Ω–∏—Ç–Ω–æ–º –ø–æ–ª–µ
while True:
    # –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –º–∞–≥–Ω–∏—Ç–Ω–æ–º –ø–æ–ª–µ (–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ –æ—Å—è–º X, Y, Z)
    print(magnetometer.magnetic)
    
    # –ó–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ 0.1 —Å–µ–∫—É–Ω–¥—ã –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º
    time.sleep(0.1)
